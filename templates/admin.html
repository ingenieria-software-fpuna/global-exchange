<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Panel de Administración - Simulador Pasarela de Pago</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 2em; background: #f5f5f5; }
        h1 { color: #333; }
        table { border-collapse: collapse; width: 100%; background: white; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        th, td { border: 1px solid #ddd; padding: 12px; text-align: left; }
        th { background: #4a90e2; color: white; font-weight: bold; }
        tbody tr:nth-child(even) { background: #f9f9f9; }
        tbody tr:hover { background: #f0f8ff; }
        .estado-exito { color: green; font-weight: bold; }
        .estado-fallo { color: red; font-weight: bold; }
        .estado-pendiente { color: orange; font-weight: bold; }
        .motivo-rechazo { color: #d32f2f; font-size: 0.9em; max-width: 200px; }
        .numero-info { font-family: monospace; color: #666; }
    </style>
</head>
<body>
    <h1>Panel de Administración</h1>
    <table>
        <thead>
            <tr>
                <th>ID Pago</th>
                <th>Monto</th>
                <th>Método</th>
                <th>Moneda</th>
                <th>Estado</th>
                <th>Número/Comprobante</th>
                <th>Motivo Rechazo</th>
                <th>Webhook</th>
                <th>Fecha</th>
            </tr>
        </thead>
        <tbody>
        {% for pago in pagos %}
            <tr>
                <td>{{ pago.id_pago }}</td>
                <td>{{ pago.monto }}</td>
                <td>{{ pago.metodo }}</td>
                <td>{{ pago.moneda }}</td>
                <td class="estado-{{ pago.estado }}">
                    {{ pago.estado.upper() }}
                </td>
                <td class="numero-info">
                    {% if pago.numero_tarjeta %}
                        Tarjeta: ****{{ pago.numero_tarjeta[-4:] }}
                    {% elif pago.numero_billetera %}
                        Billetera: {{ pago.numero_billetera }}
                    {% elif pago.numero_comprobante %}
                        Comprobante: {{ pago.numero_comprobante }}
                    {% else %}
                        -
                    {% endif %}
                </td>
                <td class="motivo-rechazo">
                    {{ pago.motivo_rechazo or '-' }}
                </td>
                <td>{{ pago.webhook_url or '-' }}</td>
                <td>{{ pago.fecha.strftime('%d/%m/%Y %H:%M:%S') if pago.fecha else '-' }}</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
</body>
</html>